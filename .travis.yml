branches: 
  only: 
    - docs
script: 
  - |
      if [ -n "$GITHUB_API_KEY" ]; then
         git config user.name "Travis CI"
         git config user.email "ganjar@sense-os.nl"

         #Get current commit id
         COMMIT_ID=`git log -1 --pretty=%h`

         #check latest changed file
         PATH_TO_FILE=$(git diff-tree --no-commit-id --name-only -r $COMMIT_ID)

         git checkout docs
         #add line to each file
         count=0
         while IFS='' read -r line || [[ -n "$line" ]]; do
            
            if [ "${line:0:1}" == "A" ]
            then
                echo $'\r' >> "${line:2}"
                git add "${line:2}"
                echo "File $count : ${line:2} done Added!"
                echo " "

            elif [ "${line:0:1}" == "D" ]
            then
                echo $'\r' >> "${line:2}"
                git rm "${line:2}"
                echo "File $count : ${line:2} done Deleted!"
                echo " "
                
            elif [ "${line:0:1}" == "M" ]
            then
                echo $'\r' >> "${line:2}"
                git rm "${line:2}"
                echo "File $count : ${line:2} done Modified!"
                echo " "
            fi

            (( count++ ))

         done <<< "$PATH_TO_FILE"

         
         COMMIT_MESSAGE=`git log -1 --pretty=%B`

         git commit -m "$COMMIT_MESSAGE"

         echo "This is List of file changed =  $PATH_TO_FILE"
         echo "This is Commit message = $COMMIT_MESSAGE"
         echo "This is Repo Slug = $TRAVIS_REPO_SLUG"

         git push https://ganjarpanji:$GITHUB_API_KEY@github.com/$TRAVIS_REPO_SLUG.wiki.git docs:master --force --quiet
      fi
